{"version":3,"sources":["cluster.js"],"names":["Cluster","config","request","paramExcludes","Request","options","callback","name","Error","path","utils","pathAppend","field","fields","getFieldSyntax","query","exclude","indices","get","node","getNodeSyntax","meta","put","commands","post","data","persistent","module","exports"],"mappings":"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","sourcesContent":["import * as utils from './utils';\nimport { Request } from 'reqlib';\n\nclass Cluster {\n\tconstructor (config, request) {\n\t\tthis.config = config;\n\t\tthis.paramExcludes = Object\n\t\t\t.keys(config)\n\t\t\t.concat(['field', 'fields', 'node', 'nodes']);\n\t\tthis.request = request || new Request(this.config);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\tdeleteRiver (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name);\n\n\t\treturn this.request.delete(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-stats/\n\tfieldStats (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.field && !options.fields) {\n\t\t\treturn callback(new Error('fields are required'));\n\t\t}\n\n\t\tlet fields = utils.getFieldSyntax(options);\n\n\t\t// specific exclude of indices param for this operation only\n\t\toptions.query = utils.exclude(options, this.paramExcludes.concat('indices'));\n\t\toptions.query.fields = fields;\n\n\t\toptions.path = utils.pathAppend(\n\t\t\toptions.indices ? '_nodes/stats/indices' : '_stats/fielddata');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-health/\n\thealth (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/health');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-hot-threads/\n\t// Warning: API is an experiment as documented on ES.org\n\thotThreads (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.path = utils.pathAppend('_nodes', node, 'hot_threads');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-info/\n\tnodesInfo (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_nodes', node);\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-stats/\n\tnodesStats (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_nodes', node, 'stats');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\tputRiver (options = {}, meta, callback) {\n\t\tif (!callback && typeof meta === 'function') {\n\t\t\tcallback = meta;\n\t\t\tmeta = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name, '_meta');\n\n\t\treturn this.request.put(options, meta, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-reroute/\n\treroute (options = {}, commands, callback) {\n\t\tif (!callback && typeof commands === 'function') {\n\t\t\tcallback = commands;\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!commands && options && options.commands) {\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/reroute');\n\n\t\treturn this.request.post(options, commands, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/river/\n\trivers (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!options.name) {\n\t\t\treturn callback(new Error('name is required'));\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_river', options.name, '_meta');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-settings/\n\tsettings (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_cluster/settings');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-nodes-shutdown/\n\tshutdown (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet node = utils.getNodeSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend('_cluster', 'nodes', node, '_shutdown');\n\n\t\treturn this.request.post(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-state/\n\tstate (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_cluster/state');\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/admin-cluster-update-settings/\n\tupdateSettings (options = {}, data, callback) {\n\t\tif (!callback && typeof data === 'function') {\n\t\t\tcallback = data;\n\t\t\tdata = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!data && options && (options.persistent || options.transient)) {\n\t\t\tdata = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_cluster/settings');\n\n\t\treturn this.request.put(options, data, callback);\n\t}\n}\n\nmodule.exports = { Cluster };"],"file":"cluster.js"}