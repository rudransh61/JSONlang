{"version":3,"sources":["core.js"],"names":["Core","config","request","paramExcludes","Request","options","doc","callback","err","utils","optionsUndefined","promiseRejectOrCallback","endpointName","create","_create","index","getIndexSyntax","query","exclude","path","pathAppend","_id","put","post","commands","Error","serializedCommands","command","documents","action","document","_index","hasOwnProperty","push","bulk","get","docs","id","multiGet","includeSource","_source","add","missingIndex","self","queries","serializedQueries","scrollId","scroll","suggest","script","module","exports"],"mappings":"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","sourcesContent":["import * as utils from './utils';\nimport { Request } from 'reqlib';\n\nclass Core {\n\tconstructor (config, request) {\n\t\tthis.config = config;\n\t\tthis.paramExcludes = Object\n\t\t\t.keys(config)\n\t\t\t.concat(['_create', '_id', '_index', '_indices', '_source']);\n\t\tthis.request = request || new Request(config);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/index_/\n\t// .add to ease backwards compatibility\n\tadd (options = {}, doc, callback) {\n\t\tif (!callback && typeof doc === 'function') {\n\t\t\tcallback = doc;\n\t\t\tdoc = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!doc) {\n\t\t\tdoc = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\t// check for _create\n\t\tlet endpointName = (options.create || options._create) ? '_create' : '';\n\t\tendpointName = endpointName || '_doc';\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\tendpointName,\n\t\t\toptions._id);\n\n\t\tif (options._id) {\n\t\t\treturn this.request.put(options, doc, callback);\n\t\t} else {\n\t\t\treturn this.request.post(options, doc, callback);\n\t\t}\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/bulk/\n\t// Note: Formats input queries as follows in POST data:\n\t//\n\t// { header : {} } \\n\n\t// { data : {} } \\n\n\t// { header : {} } \\n\n\t// { data : {} } \\n\n\t//\n\tbulk (options = {}, commands, callback) {\n\t\tif (!callback && typeof commands === 'function') {\n\t\t\tcallback = commands;\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!commands) {\n\t\t\tcommands = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!Array.isArray(commands)) {\n\t\t\treturn utils.promiseRejectOrCallback(\n\t\t\t\tnew Error('commands provided must be in array format'),\n\t\t\t\tcallback);\n\t\t}\n\n\t\tlet\n\t\t\tindex = utils.getIndexSyntax(options, null), // specifically don't want default settings\n\t\t\tserializedCommands = '';\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_bulk');\n\n\t\tcommands.forEach((command) => {\n\t\t\tserializedCommands += JSON.stringify(command) + '\\n';\n\t\t});\n\n\t\treturn this.request.post(options, serializedCommands, callback);\n\t}\n\n\t// convenience method for bulk that specifies index action\n\t// and automatically creates appropriate action/meta entries\n\t// for the documents passed\n\tbulkIndex (options = {}, documents, callback) {\n\t\tif (!callback && typeof documents === 'function') {\n\t\t\tcallback = documents;\n\t\t\tdocuments = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!documents) {\n\t\t\tdocuments = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!Array.isArray(documents)) {\n\t\t\treturn utils.promiseRejectOrCallback(\n\t\t\t\tnew Error('documents provided must be in array format'),\n\t\t\t\tcallback);\n\t\t}\n\n\t\tlet\n\t\t\taction = {},\n\t\t\tcommands = [],\n\t\t\tindex = utils.getIndexSyntax(options, this.config);\n\n\t\tdocuments.forEach((document) => {\n\t\t\taction = {\n\t\t\t\tindex : {\n\t\t\t\t\t_index : index\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// fix for issue #28, ability to handle _id property on document\n\t\t\tif (document.hasOwnProperty('_id')) {\n\t\t\t\taction.index._id = document._id;\n\t\t\t\tdelete document._id;\n\t\t\t}\n\n\t\t\tcommands.push(action);\n\t\t\tcommands.push(document);\n\t\t});\n\n\t\treturn this.bulk(options, commands, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/count/\n\tcount (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!callback && !query && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\tquery = null;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// correct situation if count is called without a query\n\t\tif (query && !query.query) {\n\t\t\toptions = query;\n\t\t\tquery = null;\n\t\t}\n\n\t\t// look for scenarios where options are omitted\n\t\tif (!query && options.query) {\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_count');\n\n\t\tif (query) {\n\t\t\treturn this.request.post(options, query, callback);\n\t\t} else {\n\t\t\treturn this.request.get(options, callback);\n\t\t}\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/delete/\n\tdelete (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_doc',\n\t\t\toptions._id);\n\n\t\treturn this.request.delete(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/delete-by-query/\n\tdeleteByQuery (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!query) {\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_query');\n\n\t\treturn this.request.delete(options, query, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/explain/\n\texplain (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index', '_id']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_explain',\n\t\t\toptions._id);\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, query, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/get/\n\tget (options = {}, callback) {\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index', '_id']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tif (Array.isArray(options._id)) {\n\t\t\tlet docs = [];\n\n\t\t\toptions._id.forEach((id) => {\n\t\t\t\tdocs.push({\n\t\t\t\t\t_id : id\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn this.multiGet(options, docs, callback);\n\t\t}\n\n\t\tlet\n\t\t\tincludeSource = options._source && options._source !== false,\n\t\t\tindex = utils.getIndexSyntax(options, this.config);\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\tincludeSource ? '_source' : '_doc',\n\t\t\toptions._id);\n\n\t\t// optionally add source filters if _source is not a boolean value\n\t\tif (includeSource && typeof options._source !== 'boolean') {\n\t\t\toptions.query._source = options._source;\n\t\t}\n\n\t\treturn this.request.get(options, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/index_/\n\t// .add to ease backwards compatibility\n\tindex (...args) {\n\t\treturn this.add(...args);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/multi-get/\n\tmultiGet (options = {}, docs, callback) {\n\t\tif (!callback && typeof docs === 'function') {\n\t\t\tcallback = docs;\n\t\t\tdocs = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!callback && typeof options === 'function') {\n\t\t\tcallback = options;\n\t\t\tdocs = null;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!docs && Array.isArray(options)) {\n\t\t\tdocs = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet\n\t\t\tmissingIndex = false,\n\t\t\tself = this;\n\n\t\tdocs.forEach((doc) => {\n\t\t\tdoc._index = doc._index || options._index || self.config._index || null;\n\n\t\t\tif (!doc._index || doc._index === null) {\n\t\t\t\tmissingIndex = true;\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\n\t\tif (missingIndex) {\n\t\t\treturn utils.promiseRejectOrCallback(\n\t\t\t\tnew Error('at least 1 or more docs supplied is missing index'),\n\t\t\t\tcallback);\n\t\t}\n\n\t\toptions.path = utils.pathAppend('_mget');\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, { docs }, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/multi-search/\n\t// Note: Formats input queries as follows in POST data:\n\t//\n\t// { query : {} } \\n\n\t// { query : {} } \\n\n\t// { query : {} } \\n\n\t//\n\tmultiSearch (options = {}, queries, callback) {\n\t\tif (!callback && typeof queries === 'function') {\n\t\t\tcallback = queries;\n\t\t\tqueries = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!queries && Array.isArray(options)) {\n\t\t\tqueries = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tif (!Array.isArray(queries)) {\n\t\t\treturn utils.promiseRejectOrCallback(\n\t\t\t\tnew Error('queries provided must be in array format'),\n\t\t\t\tcallback);\n\t\t}\n\n\t\tlet\n\t\t\tindex = utils.getIndexSyntax(options, null), // specifically want to exclude defaults\n\t\t\tserializedQueries = '';\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_msearch');\n\n\t\tqueries.forEach((query) => {\n\t\t\tserializedQueries += JSON.stringify(query);\n\t\t\tserializedQueries += '\\n';\n\t\t});\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, serializedQueries, callback);\n\t}\n\n\tquery (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where only the query is provided\n\t\tif (!query) {\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_search');\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, query, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/search/\n\t// .query to ease backwards compatibility\n\tsearch (...args) {\n\t\treturn this.query(...args);\n\t}\n\n\t// http://www.elasticsearch.org/guide/en/elasticsearch/reference/current/search-request-scroll.html\n\tscroll (options = {}, scrollId, callback) {\n\t\tif (!callback && typeof scrollId === 'function') {\n\t\t\tcallback = scrollId;\n\t\t\tscrollId = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['scroll']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\t\toptions.path = utils.pathAppend('_search/scroll');\n\n\t\t// re-map to payload expected by ES6\n\t\tif (typeof scrollId === 'string') {\n\t\t\tscrollId = {\n\t\t\t\tscroll : options.scroll,\n\t\t\t\t'scroll_id' : scrollId\n\t\t\t};\n\t\t}\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, scrollId, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/search/term-suggest/\n\t// fix for issue #29\n\tsuggest (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// check for scenarios where options are not provided\n\t\tif (!query && options.suggest) {\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\t// NOTE: in 5.0 _suggest deprecated in favor of _search endpoint\n\t\t// https://www.elastic.co/guide/en/elasticsearch/reference/current/search-suggesters.html\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_search');\n\n\t\treturn this.request.post(options, query, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/update/\n\tupdate (options = {}, doc, callback) {\n\t\tif (!callback && typeof doc === 'function') {\n\t\t\tcallback = doc;\n\t\t\tdoc = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// attempt to account for missing options\n\t\tif (!doc && (options.script || options.doc)) {\n\t\t\tdoc = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index', '_id']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\t// fix for #36 - script can be blank, but not missing\n\t\tif ((doc.script === null || typeof doc.script === 'undefined') && !doc.doc) {\n\t\t\treturn utils.promiseRejectOrCallback(\n\t\t\t\tnew Error('script or doc is required for update operation'),\n\t\t\t\tcallback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_update',\n\t\t\toptions._id);\n\n\t\treturn this.request.post(options, doc, callback);\n\t}\n\n\t// http://www.elasticsearch.org/guide/reference/api/validate/\n\tvalidate (options = {}, query, callback) {\n\t\tif (!callback && typeof query === 'function') {\n\t\t\tcallback = query;\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\t// handle scenarios where options are not provided\n\t\tif (!query && options.query) {\n\t\t\tquery = options;\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet err = utils.optionsUndefined(options, this.config, ['_index']);\n\n\t\tif (err) {\n\t\t\treturn utils.promiseRejectOrCallback(err, callback);\n\t\t}\n\n\t\tlet index = utils.getIndexSyntax(options, this.config);\n\t\toptions.query = utils.exclude(options, this.paramExcludes);\n\n\t\toptions.path = utils.pathAppend(\n\t\t\tindex,\n\t\t\t'_validate/query');\n\n\t\t// documentation indicates GET method...\n\t\t// sending POST data via GET not typical, using POST instead\n\t\treturn this.request.post(options, query, callback);\n\t}\n}\n\nmodule.exports = { Core };\n"],"file":"core.js"}